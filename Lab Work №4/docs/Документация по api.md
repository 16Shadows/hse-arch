# Документация по API

## Создание ТЭО
**Метод**: PUT

**Путь**: /teos

**Query-параметры**: -

**Accept**: application/json

**Content-type**: application/json

**Тело запроса**:

Организационные параметры ТЭО.
Пример:
```jsonc
{
	"filial": 5, //Идентификатор филиала
	"settlements": [2, 3, 4], //Идентификаторы населённых пунктов. Они должны принадлежать филиалу.
	"housing_type": 1, //Идентификатор типа жилфонда
	"name": "Пример" //Название ТЭО
}
```

**Возможные коды ответа**:

200 - Успешное добавление ТЭО.

**Тело ответа**:

Идентификатор созданного ТЭО.
Пример:
```jsonc
{
	"id": 22
}
```

## Получение списка ТЭО
**Метод**: GET

**Путь**: /teos

**Query-параметры**:

 - count - количество ТЭО в ответе. Целое число. Опциональное. От 1 до 100. По-умолчанию: 10.
 - from - идентификатор ТЭО, начиная с следующего за которым в указанном порядке сортировки будут возвращены ТЭО. Опциональное.
 - sortBy - название свойства, по которому будет сформирован порядок сортировки. Опциональное. Допустимые значения: date_created, date_updated, name, author, filial. По-умолчанию: date_created.
 - sortOrder - направление порядка сортировки. Опциональное. Допустимые значения: asc, desc. По-умолчанию: desc.

**Content-type**: application/json

**Возможные коды ответа**:

200 - Успешное возвращение списка ТЭО.
400 - некорректное значение одного или нескольких query-параметров.

**Тело ответа**:

Если код ответа 200 - список ТЭО с краткой информацией.
Пример:
```jsonc
{
	"teos": [
		{
			"id": 5, //ID ТЭО
			"name": "ТЭО 1", //Название ТЭО
			"author": "Автор", //Автор
			"date_created": "2022-01-01T16:22:13", //Дата создание ТЭО UTC
			"date_updated": "2022-01-01T16:25:13", //Дата обновления ТЭО UTC
			"filial": { //Филиал
				"id": 1,
				"name": "Пермь ЭРТХ"
			},
			"settlements": [ //Населённые пункты
				{
					"id": 2,
					"name": "Пермь"
				},
				{
					"id": 3,
					"name": "Краснокамск"
				}
			],
			"housing_type": { //Тип жилфонда
				"id": 1,
				"name": "Малоэтажный жилфонд"
			}
		}
	]
}
```

Если код ответа 400 - список query-параметров с ошибками.
Пример:
```jsonc
{
	"invalid_params": [
		"count",
		"from"
	]
}
```

## Получение данных ТЭО
**Метод**: GET

**Путь**: /teos/{teo_id} ; teo_id - идентификатор ТЭО.

**Query-параметры**: -

**Content-type**: application/json

**Возможные коды ответа**:

200 - Успешное удаление ТЭО.
404 - ТЭО с указанным идентификатором не существует.

**Тело ответа**:

Если код ответа 200 - объект ТЭО с краткой информацией.
Пример:
```jsonc
{
	"id": 5, //ID ТЭО
	"name": "ТЭО 1", //Название ТЭО
	"author": "Автор", //Автор
	"date_created": "2022-01-01T16:22:13", //Дата создание ТЭО UTC
	"date_updated": "2022-01-01T16:25:13", //Дата обновления ТЭО UTC
	"filial": { //Филиал
		"id": 1,
		"name": "Пермь ЭРТХ"
	},
	"settlements": [ //Список населённых пунктов
		{
			"id": 2,
			"name": "Пермь"
		},
		{
			"id": 3,
			"name": "Краснокамск"
		}
	],
	"housing_type": { //Тип жилфонда
		"id": 1,
		"name": "Малоэтажный жилфонд"
	}
}
```

Если код ответа 404 - тела нет.

## Обновление данных ТЭО
**Метод**: POST

**Путь**: /teos/{teo_id} ; teo_id - идентификатор ТЭО.

**Query-параметры**: -

**Accept**: application/json

**Content-type**: application/json

**Тело запроса**:

Организационные параметры ТЭО. Каждое поле опционально, но хотя бы одно должно быть указано.
Пример:
```jsonc
{
	"filial": 1, //Идентификатор филиала
	"settlements": [2, 3, 4], //Идентификаторы населённых пунктов. Они должны принадлежать филиалу.
	"housing_type": 1, //Идентификатор типа жилфонда
	"name": "Пример" //Название ТЭО
}
```

**Возможные коды ответа**:

200 - Успешное обновление ТЭО.
404 - ТЭО с таким идентификатором не существует.

**Тело ответа**:

Краткая информация о текущем ТЭО.
Пример:
```jsonc
{
	"id": 5, //ID ТЭО
	"name": "Пример", //Название ТЭО
	"author": "Автор", //Автор
	"date_created": "2022-01-01T16:22:13", //Дата создание ТЭО UTC
	"date_updated": "2022-01-01T16:25:13", //Дата обновления ТЭО UTC
	"filial": { //Филиал
		"id": 1,
		"name": "Пермь ЭРТХ"
	},
	"settlements": [ //Список населённых пунктов
		{
			"id": 2,
			"name": "Пермь"
		},
		{
			"id": 3,
			"name": "Краснокамск"
		},
		{
			"id": 4,
			"name": "Добрянка"
		}
	],
	"housing_type": { //Тип жилфонда
		"id": 1,
		"name": "Малоэтажный жилфонд"
	}
}
```

## Удаление ТЭО
**Метод**: DELETE

**Путь**: /teos/{teo_id}. teo_id - идентификатор ТЭО.

**Query-параметры**: -

**Возможные коды ответа**:

200 - Успешное удаление ТЭО.
404 - ТЭО с указанным идентификатором не существует.

## Получение списка филиалов
**Метод**: GET

**Путь**: /filials

**Content-type**: application/json

**Возможные коды ответа**:

200 - успешное получение списка филиалов.

**Тело ответа**:

Список филиалов.
Пример:
```jsonc
{
	"filials": [ //Филиалы
		{
			"id": 1,
			"name": "Пермь ЭРТХ"
		},
		{
			"id": 2,
			"name": "Барнаул ЭРТХ"
		}
	]
}
```

## Получение списка населённых пунктов в филиале
**Метод**: GET

**Путь**: /filials/{filial_id}/settlements ; filial_id - идентификатор филиала

**Content-type**: application/json

**Возможные коды ответа**:

200 - успешное получение списка населённых пунктов в филиале.
404 - филиала с указанным идентификатором не существует.

**Тело ответа**:

Если код 200 - список населённых пунктов в филиале.
Пример:
```jsonc
{
	"settlements": [ //Список населённых пунктов
		{
			"id": 1,
			"name": "Пермь ЭРТХ"
		},
		{
			"id": 2,
			"name": "Барнаул ЭРТХ"
		}
	]
}
```

Если код 404 - тела нет.

## Получение типов жилфонда
**Метод**: GET

**Путь**: /housing_types

**Content-type**: application/json

**Возможные коды ответа**:

200 - успешное получение списка ТЭО.

**Тело ответа**:

Список типов жилфонда.
Пример:
```jsonc
{
	"housing_types": [ //Типы жилфонда
		{
			"id": 1,
			"name": "Малоэтажный жилфонд"
		},
		{
			"id": 2,
			"name": "Частный сектор"
		}
	]
}
```